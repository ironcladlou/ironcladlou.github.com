
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Integrating XBMC, Netflix, and Steam - Dan Mace</title>
  <meta name="author" content="Dan Mace">

  
  <meta name="description" content="With my core gaming HTPC in place and wireless connectivity and no trouble along the way, I found some interesting challenges with software &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ironcladlou.github.com/blog/2012/12/21/integrating-xbmc-netflix-and-steam/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Dan Mace" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6596598-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">&nbsp;</div>
  	<div id="logoText">&nbsp;</div>
  	<div id="logoRight">></div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Dan Mace</a></h1>
  
    <h2>Deputy Cultural Attach√© at the West Virginia consulate</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ironcladlou.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Integrating XBMC, Netflix, and Steam</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2012-12-21T21:35:00-05:00" pubdate data-updated="true">Dec 21<span>st</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>With my <a href="/blog/2012/12/21/gaming-htpc-fundamentals/">core gaming HTPC</a> in place and <a href="/blog/2012/12/21/adding-wireless-everything-to-the-gaming-htpc/">wireless connectivity</a> and no trouble along the way, I found some interesting challenges with software integration. Ultimately, I found a way to almost seamlessly integrate XBMC, Steam, and Netflix using XBMC as the primary front-end. It took some hacking, but was well worth it, and best of all: no keyboard or mouse required.</p>

<!-- more -->


<h2>XBMC can do it all</h2>

<p>I&#8217;ve been using XBMC since it debuted for the original XBox, and it has been the center of my home&#8217;s entertainment setup ever since. With the new gaming HTPC setup, I was concerned XBMC would take a backseat, given the necessity to use Windows Media Center for Netflix and Steam for game launching.</p>

<p>I should have known there was already a plugin for that.</p>

<p>The XBMC <a href="http://wiki.xbmc.org/index.php?title=Add-on:Advanced_Launcher">Advanced Launcher</a> add-on allows you to launch arbitrary executables from a menu. The launchers you create can be added to the XBMC favorites list, making them assignable to pretty much anywhere in the UI (provided you&#8217;re using a nicely configurable skin such as <a href="http://xbmc.org/skins/aeon/">Aeon</a>).</p>

<p>This provides the foundational support necessary to let us launch Steam and Windows Media Center. Of course, launching those particular applications is not as straightforward as I had hoped&#8230;</p>

<h2>AutoHotkey to the rescue</h2>

<p>An amazing little open source tool called <a href="http://www.autohotkey.com/">AutoHotkey</a> fills the gaping hole in Windows&#8217; automation capabilities, facilitating all manner of UI, window, and process scripting tasks. As icing on the cake, it includes a compiler which allows you to generate standalone executables from your scripts, easing the integration with launches such as the Advanced Launcher XBMC add-on.</p>

<p>This is an extremely useful tool in my HTPC setup, as merely launching executables such as Steam and Windows Media Center is not quite enough for the seamless integration I want. For example, although it&#8217;s possible to launch Steam from the command line in Big Picture mode, exiting BPM will leave XBMC unfocused. This is a recurring theme when launching other fullscreen apps from XBMC in this manner.</p>

<p>Using AutoHotkey, it&#8217;s possible not only to launch the target applications, but also restore focus to XBMC when they exit, as well as perform any other bits of UI automation which might be required to get the programs in a good working state without having to touch a keyboard or mouse.</p>

<p>Everything else in this article builds on AutoHotkey in some way.</p>

<h2>First, the easy one: Steam</h2>

<p>Steam turned out to be pretty simple. It is well behaved, has a direct entry point, and has easy access to exit it and return to XBMC. The following is an example AutoHotkey script which will launch or focus Steam Big Picture, and re-focus XBMC upon closing BPM:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#NoEnv  
</span><span class='line'>SendMode Input
</span><span class='line'>SetWorkingDir %A_ScriptDir%
</span><span class='line'>#Persistent
</span><span class='line'>#SingleInstance
</span><span class='line'>
</span><span class='line'>if WinExist("ahk_class CUIEngineWin32")
</span><span class='line'>  WinActivate
</span><span class='line'>else
</span><span class='line'>  run, %A_ProgramFiles%\Steam\Steam.exe -silent steam://open/bigpicture
</span><span class='line'>
</span><span class='line'>WinWait, ahk_class CUIEngineWin32
</span><span class='line'>WinWaitClose, ahk_class CUIEngineWin32
</span><span class='line'>WinActivate ahk_class XBMC
</span><span class='line'>ExitApp</span></code></pre></td></tr></table></div></figure>


<p>If Steam is installed somewhere other than <code>Program Files</code>, you&#8217;ll need to edit the script (or introduce a parameter).</p>

<p>Compile the script, set up an XBMC Advanced Launcher entry to execute it, and you&#8217;re all set.</p>

<h2>Jumping through hoops for Netflix</h2>

<p>The only way I know of to use Netflix in a remote-compatible way in Windows is via the Netflix plugin within Windows Media Center. The arcane and opaque nature of WMC made figuring out how to launch the Netflix plugin directly from the command line a bit trickier. I lucked out with some Google searching, and was able to find a command to jump straight to Netflix. Caveat: There is a benign proxy error that appears during the Netflix loading which must be dismissed. It&#8217;s possible to automatically dismiss it with AutoHotkey, but I haven&#8217;t yet spent the time to do so. Here&#8217;s the script:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>TODO: Insert the script upon my glorious return to the home</span></code></pre></td></tr></table></div></figure>


<p>One other minor annoyance is that exiting Windows Media Center with the remote takes some menu diving. There&#8217;s probably a faster way to accomplish it, but I haven&#8217;t cared enough to figure it out yet.</p>

<h2>What else?</h2>

<p>At this point, I had accomplished every basic thing I had set out to do. I spent some time customizing my XBMC skin so that I could launch Netflix and Steam from the main menu directly, and called it a success.</p>

<p>Hopefully somebody else will find these articles to be useful shortcuts in their own HTPC adventures.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Dan Mace</span></span>

      








  


<time datetime="2012-12-21T21:35:00-05:00" pubdate data-updated="true">Dec 21<span>st</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/htpc/'>htpc</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/2012/12/21/adding-wireless-everything-to-the-gaming-htpc/" title="Previous Post: Adding wireless everything to the gaming HTPC">&laquo; Adding wireless everything to the gaming HTPC</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/21/integrating-xbmc-netflix-and-steam/">Integrating XBMC, Netflix, and Steam</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/21/adding-wireless-everything-to-the-gaming-htpc/">Adding wireless everything to the gaming HTPC</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/21/gaming-htpc-fundamentals/">Gaming HTPC Fundamentals</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/ironcladlou">@ironcladlou</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'ironcladlou',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Dan Mace -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'danmace';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ironcladlou.github.com/blog/2012/12/21/integrating-xbmc-netflix-and-steam/';
        var disqus_url = 'http://ironcladlou.github.com/blog/2012/12/21/integrating-xbmc-netflix-and-steam/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
